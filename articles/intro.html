<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="sodium">
<title>Sodium: A Modern and Easy-to-Use Crypto Library • sodium</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sodium: A Modern and Easy-to-Use Crypto Library">
<meta property="og:description" content="sodium">
<meta property="og:image" content="https://docs.ropensci.org/sodium/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">sodium</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.3.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/crypto101.html">How does cryptography work?</a>
    <a class="dropdown-item" href="../articles/intro.html">Sodium: A Modern and Easy-to-Use Crypto Library</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-lib/sodium/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Sodium: A Modern and Easy-to-Use Crypto Library</h1>
            
            <h4 data-toc-skip class="date">2024-03-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/r-lib/sodium/blob/HEAD/vignettes/intro.rmd" class="external-link"><code>vignettes/intro.rmd</code></a></small>
      <div class="d-none name"><code>intro.rmd</code></div>
    </div>

    
    
<p>The sodium R package provides bindings to <a href="https://libsodium.gitbook.io/" class="external-link">libsodium</a>: a modern, easy-to-use software library for encryption, decryption, signatures, password hashing and more.</p>
<p>The goal of Sodium is to provide the core operations needed to build higher-level cryptographic tools. It is not intended for implementing standardized protocols such as TLS, SSH or GPG. Sodium only supports a limited set of state-of-the-art elliptic curve methods, resulting in a simple but very powerful tool-kit for building secure applications.</p>
<table class="table">
<colgroup>
<col width="23%">
<col width="26%">
<col width="28%">
<col width="21%">
</colgroup>
<thead><tr class="header">
<th align="right"></th>
<th align="center">Authenticated Encryption</th>
<th align="center">Encryption only</th>
<th align="center">Authentication only</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">
<strong>Symmetric</strong> <em>(secret key)</em>:</td>
<td align="center"><a href="#secret-key-encryption"><code>data_encrypt</code> / <code>data_decrypt</code></a></td>
<td align="center"></td>
<td align="center"><a href="#secret-key-authentication"><code>data_tag</code></a></td>
</tr>
<tr class="even">
<td align="right">
<strong>Asymmetric</strong> <em>(public+private key)</em>:</td>
<td align="center"><a href="#public-key-authenticated-encryption"><code>auth_encrypt</code> / <code>auth_decrypt</code></a></td>
<td align="center"><a href="#public-key-encryption"><code>simple_encrypt</code> / <code>simple_decrypt</code></a></td>
<td align="center"><a href="#public-key-authentication-signatures"><code>sig_sign</code> / <code>sig_verify</code></a></td>
</tr>
<tr class="odd">
<td align="right"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="using-sodium">Using Sodium<a class="anchor" aria-label="anchor" href="#using-sodium"></a>
</h3>
<p>All Sodium functions operate on binary data, called ‘raw’ vectors in R. Use <code>charToRaw</code> and <code>rawToChar</code> to convert between strings and raw vectors. Alternatively <code>hex2bin</code> and <code>bin2hex</code> can convert between binary data to strings in hex notation:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hash.html">hash</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rawConversion.html" class="external-link">charToRaw</a></span><span class="op">(</span><span class="st">"test 123"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">str</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/helpers.html">bin2hex</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">str</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] "e8b785b02e702c0b7edc9683130db36c91e0241ba0c489ff1e20cbb4fa3920f9"</code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/helpers.html">hex2bin</a></span><span class="op">(</span><span class="va">str</span><span class="op">)</span></span></code></pre></div>
<pre><code> [1] e8 b7 85 b0 2e 70 2c 0b 7e dc 96 83 13 0d b3 6c 91 e0 24 1b a0 c4 89 ff 1e
[26] 20 cb b4 fa 39 20 f9</code></pre>
</div>
<div class="section level3">
<h3 id="random-data-generator">Random data generator<a class="anchor" aria-label="anchor" href="#random-data-generator"></a>
</h3>
<p>The <code><a href="../reference/helpers.html">random()</a></code> function generates n bytes of unpredictable data, suitable for creating secret keys.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">secret</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/helpers.html">random</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">secret</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 09 c5 b5 ed 7e 11 d3 14</code></pre>
<p>Implementation is platform specific, see the <a href="https://libsodium.gitbook.io/doc/generating_random_data" class="external-link">docs</a> for details.</p>
</div>
<div class="section level3">
<h3 id="hash-functions">Hash functions<a class="anchor" aria-label="anchor" href="#hash-functions"></a>
</h3>
<p>Sodium has several hash functions including <code><a href="../reference/hash.html">hash()</a></code>, <code><a href="../reference/hash.html">shorthash()</a></code>, <code><a href="../reference/hash.html">sha256()</a></code>, <code>sha512</code> and <code><a href="../reference/hash.html">scrypt()</a></code>. The generic <code><a href="../reference/hash.html">hash()</a></code> is usually recommended. It uses <a href="https://doc.libsodium.org/hashing/generic_hashing.html" class="external-link">blake2b</a> with a configurable size between 16 bytes (128bit) and 64 bytes (512bit).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate keys from passphrase</span></span>
<span><span class="va">passphrase</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rawConversion.html" class="external-link">charToRaw</a></span><span class="op">(</span><span class="st">"This is super secret"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/hash.html">hash</a></span><span class="op">(</span><span class="va">passphrase</span><span class="op">)</span></span></code></pre></div>
<pre><code> [1] 98 5c 9b b6 f6 92 d5 26 10 80 99 25 3e a5 a6 66 67 13 fd 88 10 b6 12 74 86
[26] c8 e9 5c 44 07 45 f5</code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hash.html">hash</a></span><span class="op">(</span><span class="va">passphrase</span>, size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span></code></pre></div>
<pre><code> [1] eb 6c df 04 18 40 16 28 c1 b0 2e 76 f3 e6 bd 89</code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hash.html">hash</a></span><span class="op">(</span><span class="va">passphrase</span>, size <span class="op">=</span> <span class="fl">64</span><span class="op">)</span></span></code></pre></div>
<pre><code> [1] d0 89 68 30 26 1d 1b 85 76 dc ad 20 c9 58 0a fb b1 d0 62 ba 10 d6 80 f6 cb
[26] c6 ae 2d 42 57 ee a0 65 fd b0 e8 90 02 ae b3 e0 4f 88 df ba ea 26 bb 47 3f
[51] 29 5a a4 06 cd b8 05 78 83 31 66 dc 7b 24</code></pre>
<p>The <code><a href="../reference/hash.html">shorthash()</a></code> function is a special 8 byte (64 bit) hash based on <a href="https://doc.libsodium.org/hashing/short-input_hashing.html" class="external-link">SipHash-2-4</a>. The output of this function is only 64 bits (8 bytes). It is useful for in e.g. Hash tables, but it should not be considered collision-resistant.</p>
</div>
<div class="section level3">
<h3 id="secret-key-encryption">Secret key encryption<a class="anchor" aria-label="anchor" href="#secret-key-encryption"></a>
</h3>
<p>Symmetric encryption uses the same secret key for both encryption and decryption. It is mainly useful for encrypting local data, or as a building block for more complex methods.</p>
<p>Most encryption methods require a <code>nonce</code>: a piece of non-secret unique data that is used to randomize the cipher. This allows for safely using the same <code>key</code> for encrypting multiple messages. The nonce should be stored or shared along with the ciphertext.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">key</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hash.html">hash</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rawConversion.html" class="external-link">charToRaw</a></span><span class="op">(</span><span class="st">"This is a secret passphrase"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/serialize.html" class="external-link">serialize</a></span><span class="op">(</span><span class="va">iris</span>, <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Encrypt with a random nonce</span></span>
<span><span class="va">nonce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/helpers.html">random</a></span><span class="op">(</span><span class="fl">24</span><span class="op">)</span></span>
<span><span class="va">cipher</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/symmetric.html">data_encrypt</a></span><span class="op">(</span><span class="va">msg</span>, <span class="va">key</span>, <span class="va">nonce</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Decrypt with same key and nonce</span></span>
<span><span class="va">orig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/symmetric.html">data_decrypt</a></span><span class="op">(</span><span class="va">cipher</span>, <span class="va">key</span>, <span class="va">nonce</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://rdrr.io/r/base/serialize.html" class="external-link">unserialize</a></span><span class="op">(</span><span class="va">orig</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<p>Because the secret has to be known by all parties, symmetric encryption by itself is often impractical for communication with third parties. For this we need asymmetric (public key) methods.</p>
</div>
<div class="section level3">
<h3 id="secret-key-authentication">Secret key authentication<a class="anchor" aria-label="anchor" href="#secret-key-authentication"></a>
</h3>
<p>Secret key authentication is called tagging in Sodium. A tag is basically a hash of the data together with a secret key.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">key</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hash.html">hash</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rawConversion.html" class="external-link">charToRaw</a></span><span class="op">(</span><span class="st">"This is a secret passphrase"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/serialize.html" class="external-link">serialize</a></span><span class="op">(</span><span class="va">iris</span>, <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">mytag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/symmetric.html">data_tag</a></span><span class="op">(</span><span class="va">msg</span>, <span class="va">key</span><span class="op">)</span></span></code></pre></div>
<p>To verify the integrity of the data at a later point in time, simply re-calculate the tag with the same key:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">mytag</span>, <span class="fu"><a href="../reference/symmetric.html">data_tag</a></span><span class="op">(</span><span class="va">msg</span>, <span class="va">key</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The secret key protects against forgery of the data+tag by an intermediate party, as would be possible with a regular checksum.</p>
</div>
<div class="section level3">
<h3 id="public-key-encryption">Public key encryption<a class="anchor" aria-label="anchor" href="#public-key-encryption"></a>
</h3>
<p>Where symmetric methods use the same secret key for encryption and decryption, asymmetric methods use a key-pair consisting of a public key and private key. The private key is secret and only known by its owner. The public key on the other hand can be shared with anyone. Public keys are often published on the user’s website or posted in public directories or keyservers.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">key</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/keygen.html">keygen</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">pub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/keygen.html">pubkey</a></span><span class="op">(</span><span class="va">key</span><span class="op">)</span></span></code></pre></div>
<p>In public key encryption, data encrypted with a public key can only be decrypted using the corresponding private key. This allows anyone to send somebody a secure message by encrypting it with the receivers public key. The encrypted message will only be readable by the owner of the corresponding private key.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Encrypt message with pubkey</span></span>
<span><span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/serialize.html" class="external-link">serialize</a></span><span class="op">(</span><span class="va">iris</span>, <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">ciphertext</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simple.html">simple_encrypt</a></span><span class="op">(</span><span class="va">msg</span>, <span class="va">pub</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Decrypt message with private key</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simple.html">simple_decrypt</a></span><span class="op">(</span><span class="va">ciphertext</span>, <span class="va">key</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">out</span>, <span class="va">msg</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="public-key-authentication-signatures">Public key authentication (signatures)<a class="anchor" aria-label="anchor" href="#public-key-authentication-signatures"></a>
</h3>
<p>Public key authentication works the other way around. First, the owner of the private key creates a ‘signature’ (an authenticated checksum) for a message in a way that allows anyone who knows his/her public key to verify the integrity of the message and identity of the sender.</p>
<p>Currently sodium requires a different type of key-pair for signatures (ed25519) than for encryption (curve25519).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate signature keypair</span></span>
<span><span class="va">key</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sig.html">sig_keygen</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">pubkey</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sig.html">sig_pubkey</a></span><span class="op">(</span><span class="va">key</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create signature with private key</span></span>
<span><span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/serialize.html" class="external-link">serialize</a></span><span class="op">(</span><span class="va">iris</span>, <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">sig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sig.html">sig_sign</a></span><span class="op">(</span><span class="va">msg</span>, <span class="va">key</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sig</span><span class="op">)</span></span></code></pre></div>
<pre><code> [1] 62 49 b8 42 15 76 82 48 62 02 85 0d a5 ae 08 47 5b 98 e1 dc 8e 4d 34 d5 67
[26] 1b 4c d9 6f 9e f9 6f 10 d6 26 25 c7 bd 34 cb f3 bb c9 49 ab 0b a2 e8 4e f1
[51] 98 fb 1b fb fa 6e 1f c5 e1 df 4a 23 e9 04</code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Verify a signature from public key</span></span>
<span><span class="fu"><a href="../reference/sig.html">sig_verify</a></span><span class="op">(</span><span class="va">msg</span>, <span class="va">sig</span>, <span class="va">pubkey</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<p>Signatures are useful when the message itself is not confidential but integrity is important. A common use is for software repositories where to include an index file with checksums for all packages, signed by the repository maintainer. This allows client package managers to verify that the binaries were not manipulated by intermediate parties during the distribution process.</p>
</div>
<div class="section level3">
<h3 id="public-key-authenticated-encryption">Public key authenticated encryption<a class="anchor" aria-label="anchor" href="#public-key-authenticated-encryption"></a>
</h3>
<p>Authenticated encryption implements best practices for secure messaging. It requires that both sender and receiver have a keypair and know each other’s public key. Each message gets authenticated with the key of the sender and encrypted with the key of the receiver.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Bob's keypair:</span></span>
<span><span class="va">bob_key</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/keygen.html">keygen</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">bob_pubkey</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/keygen.html">pubkey</a></span><span class="op">(</span><span class="va">bob_key</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Alice's keypair:</span></span>
<span><span class="va">alice_key</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/keygen.html">keygen</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">alice_pubkey</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/keygen.html">pubkey</a></span><span class="op">(</span><span class="va">alice_key</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Bob sends encrypted message for Alice:</span></span>
<span><span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rawConversion.html" class="external-link">charToRaw</a></span><span class="op">(</span><span class="st">"TTIP is evil"</span><span class="op">)</span></span>
<span><span class="va">ciphertext</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/messaging.html">auth_encrypt</a></span><span class="op">(</span><span class="va">msg</span>, <span class="va">bob_key</span>, <span class="va">alice_pubkey</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Alice verifies and decrypts with her key</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/messaging.html">auth_decrypt</a></span><span class="op">(</span><span class="va">ciphertext</span>, <span class="va">alice_key</span>, <span class="va">bob_pubkey</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">out</span>, <span class="va">msg</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Alice sends encrypted message for Bob</span></span>
<span><span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rawConversion.html" class="external-link">charToRaw</a></span><span class="op">(</span><span class="st">"Let's protest"</span><span class="op">)</span></span>
<span><span class="va">ciphertext</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/messaging.html">auth_encrypt</a></span><span class="op">(</span><span class="va">msg</span>, <span class="va">alice_key</span>, <span class="va">bob_pubkey</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Bob verifies and decrypts with his key</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/messaging.html">auth_decrypt</a></span><span class="op">(</span><span class="va">ciphertext</span>, <span class="va">bob_key</span>, <span class="va">alice_pubkey</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">out</span>, <span class="va">msg</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Note that even though public keys are not confidential, you should not exchange them over the same insecure channel you are trying to protect. If the connection is being tampered with, the attacker could simply replace the key with another one to hijack the interaction.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
